---
title: "Audio Features Analysis of Ed Sheeran's Music on Spotify"
author: "Your Name"
date: "2024-10-08"
format: pdf
execute:
  warning: false   # Suppress all warnings globally
  message: false   # Suppress all messages globally
  echo: false  
---

```{r}
#| include: false
#| warning: false
#| message: false
# Install devtools if you don't have it
# Set CRAN mirror
options(repos = c(CRAN = "https://cloud.r-project.org"))

install.packages("devtools")

# Use devtools to install spotifyr from GitHub
devtools::install_github("charlie86/spotifyr")

# Load the spotifyr library
library(spotifyr)

# Install dplyr if you don't have it yet
install.packages("dplyr")

# Load the dplyr library
library(dplyr)

# Load tidyverse for other utilities
install.packages("tidyverse")
library(tidyverse)

# Load usethis to set environment variables
library(usethis)
```

# Introduction

Ed Sheeran is one of the most successful and influential contemporary artists, known for his blend of pop, folk, and acoustic music. His songs are consistently streamed by millions across platforms like Spotify. This report uses data from Spotify to analyze Ed Sheeran’s music over time, exploring key features such as track popularity, duration, and other audio characteristics like energy, danceability, and valence. These metrics provide insight into his evolving musical style and listener preferences.

# Data Collection

Using the `spotifyr` package in R, data on Ed Sheeran’s tracks were collected through Spotify’s Web API. Audio features such as **popularity**, **duration**, and other key characteristics were retrieved. These features, available through Spotify’s proprietary algorithms, provide insights into how songs are perceived (e.g., popularity) and their structural properties (e.g., duration, energy, danceability).

The data was saved as `ed_sheeran_data.rds` and analyzed to explore trends in Ed Sheeran's music.

```{r}
#| include: false
usethis::edit_r_environ()

```

```{r}
#| include: false
# Authenticate with Spotify
access_token <- get_spotify_access_token()

```

```{r}
#| include: false
ed_sheeran_data <- get_artist_audio_features("ed sheeran")

saveRDS(ed_sheeran_data, "ed_sheeran_data.rds")
ed_sheeran_data <- readRDS("ed_sheeran_data.rds")

# Inspect the structure of the data
str(ed_sheeran_data)

```

# Analysis and Findings

## Song Duration Trends Next, we explore the average duration of Ed Sheeran's songs. Has he tended to produce longer or shorter tracks over time?

```{r}
#| echo: false
#| label: fig-song-duration
#| fig-cap: "Song Duration Over Time for Ed Sheeran"
library(ggplot2)
library(dplyr)

ed_sheeran_data %>%
  mutate(album_release_date = as.Date(album_release_date)) %>%
  ggplot(aes(x = album_release_date, y = duration_ms)) +
  geom_point() +
  labs(x = "Album Release Date", y = "Duration (ms)") +
  theme_minimal()

```

The graph indicates that Ed Sheeran's song durations have remained relatively stable, with most songs ranging between 180,000 and 240,000 milliseconds (around 3 to 4 minutes). While there are a few longer songs, the trend line shows no significant increase or decrease in song length over time.

## Valence of Ed Sheeran's Songs Over Time
Valence describes the musical positivity of a track, with higher values indicating happier or more positive songs. In this analysis, we explore how Ed Sheeran’s songs have varied in valence over the course of his career.
```{r}
#| echo: false
#| label: fig-valence-over-time
#| fig-cap: "Valence (Positivity) of Ed Sheeran's Songs Over Time"
ed_sheeran_data %>%
  mutate(album_release_date = as.Date(album_release_date)) %>%
  ggplot(aes(x = album_release_date, y = valence)) +
  geom_point() +
  geom_smooth(method = "loess", color = "green") +
  labs(title = "Valence (Positivity) of Ed Sheeran's Songs Over Time",
       x = "Album Release Date",
       y = "Valence (Positivity)") +
  theme_minimal()

```

As we can see, albums such as No.6 Collaborations Project have higher average danceability, reflecting Ed Sheeran's collaborations with artists known for more upbeat tracks.

# Conclusion
This analysis highlights several interesting trends in Ed Sheeran’s music. His song popularity shows spikes around major album releases, and while the duration of his songs remains consistent, the energy, danceability, and valence of his music shift across different albums. These insights reveal the versatility in Ed Sheeran's music style, adapting to different musical influences while maintaining a consistent appeal to his audience.

# Appendix
```{r}
#| echo: false
#| label: fig-danceability-distribution
#| fig-cap: "Distribution of Danceability in Ed Sheeran's Songs"
# Plot the distribution of danceability
ggplot(ed_sheeran_data, aes(x = danceability)) +
  geom_histogram(bins = 20, fill = "lightblue", color = "black") +
  labs(title = "Distribution of Danceability in Ed Sheeran's Songs",
       x = "Danceability",
       y = "Count") +
  theme_minimal()

```

\newpage

# References